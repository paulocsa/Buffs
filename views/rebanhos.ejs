<%- include('partials/header.ejs') %>
<%- include('partials/nav.ejs') %>
<%- include('partials/sidebar.ejs') %>
<div class="container my-4">
    <header class="d-flex justify-content-between align-items-center mb-4">
        <h1>Controle de Rebanhos</h1>
        <div>
            <button class="btn btn-dark" data-toggle="modal" data-target="#createBufaloModal">+ Adicionar Bubalino</button>
            <button class="btn btn-dark">Exportar dados</button>
        </div>
    </header>
    <section class="mb-4">
        <h2>Parâmetros de pesquisa</h2>
        <form class="form-row">
            <!-- Formulário de pesquisa -->
            <div class="form-group col-md-2">
                <label for="tag">Tag</label>
                <input type="text" class="form-control" id="tag" placeholder="#">
            </div>
            <div class="form-group col-md-2">
                <label for="nome">Nome</label>
                <input type="text" class="form-control" id="nome">
            </div>
            <div class="form-group col-md-2">
                <label for="data-nascimento">Data de Nascimento</label>
                <input type="date" class="form-control" id="data-nascimento" placeholder="__/__/____">
            </div>
            <div class="form-group col-md-2">
                <label for="peso">Peso</label>
                <input type="text" class="form-control" id="peso" placeholder="kg">
            </div>
            <div class="form-group col-md-2">
                <label for="raca">Raça</label>
                <input type="text" class="form-control" id="raca">
            </div>
            <div class="form-group col-md-2">
                <label for="sexo">Sexo</label>
                <input type="text" class="form-control" id="sexo">
            </div>
            <div class="form-group col-12">
                <button type="submit" class="btn btn-dark">Consultar</button>
            </div>
        </form>
    </section>
    <section>
        <h2>Bubalinos cadastrados</h2>
        <table class="table table-striped table-bordered">
            <thead class="thead-dark">
                <tr>
                    <th>Nome Búfala</th>
                    <th>Tag</th>
                    <th>Raça</th>
                    <th>Sexo</th>
                    <th>Data de nascimento</th>
                    <th>Peso</th>
                    <th>Ver mais</th>
                </tr>
            </thead>
            <tbody>
                <% bufalos.forEach(bufalo => { %>
                <tr>
                    <td><%= bufalo.nome %></td>
                    <td><%= bufalo.tag %></td>
                    <td><%= bufalo.raca %></td>
                    <td><%= bufalo.sexo %></td>
                    <td><%= new Date(bufalo.dataNascimento).toLocaleDateString() %></td>
                    <td><%= bufalo.peso %>kg</td>
                    <td>
                        <button class="btn btn-link" data-toggle="modal" data-target="#viewBufaloModal<%= bufalo.id %>"><img src="/add.icondepois" alt="Ver mais" width="24"></button>
                    </td>
                </tr>

                <!-- Modal Ver Mais -->
                <div class="modal fade" id="viewBufaloModal<%= bufalo.id %>" tabindex="-1" role="dialog" aria-labelledby="viewBufaloModalLabel<%= bufalo.id %>" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="viewBufaloModalLabel<%= bufalo.id %>">Ficha do Búfalo</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <p><strong>Nome:</strong> <%= bufalo.nome %></p>
                                <p><strong>Tag:</strong> <%= bufalo.tag %></p>
                                <p><strong>Raça:</strong> <%= bufalo.raca %></p>
                                <p><strong>Sexo:</strong> <%= bufalo.sexo %></p>
                                <p><strong>Data de Nascimento:</strong> <%= new Date(bufalo.dataNascimento).toLocaleDateString() %></p>
                                <p><strong>Peso:</strong> <%= bufalo.peso %>kg</p>
                                <p><strong>Valor Arroba:</strong> <%= bufalo.valorArroba %></p>
                                <p><strong>Idade:</strong> <%= bufalo.idade %></p>

                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#editBufaloModal<%= bufalo.id %>">Editar</button>
                                <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#deleteBufaloModal<%= bufalo.id %>">Excluir</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal Editar -->
                <div class="modal fade" id="editBufaloModal<%= bufalo.id %>" tabindex="-1" role="dialog" aria-labelledby="editBufaloModalLabel<%= bufalo.id %>" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="editBufaloModalLabel<%= bufalo.id %>">Editar Búfalo</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <form action="/updateBufalo/<%= bufalo.id %>" method="POST">
                                    <div class="form-group">
                                        <label for="tag<%= bufalo.id %>">Tag</label>
                                        <input type="text" class="form-control" id="tag<%= bufalo.id %>" name="tag" value="<%= bufalo.tag %>">
                                    </div>
                                    <div class="form-group">
                                        <label for="valorArroba<%= bufalo.id %>">Valor Arroba</label>
                                        <input type="text" class="form-control" id="valorArroba<%= bufalo.id %>" name="valorArroba" value="<%= bufalo.valorArroba %>">
                                    </div>
                                    <div class="form-group">
                                        <label for="nome<%= bufalo.id %>">Nome</label>
                                        <input type="text" class="form-control" id="nome<%= bufalo.id %>" name="nome" value="<%= bufalo.nome %>">
                                    </div>
                                    <div class="form-group">
                                        <label for="idade<%= bufalo.id %>">Idade</label>
                                        <input type="text" class="form-control" id="idade<%= bufalo.id %>" name="idade" value="<%= bufalo.idade %>">
                                    </div>
                                    <div class="form-group">
                                        <label for="peso<%= bufalo.id %>">Peso</label>
                                        <input type="text" class="form-control" id="peso<%= bufalo.id %>" name="peso" value="<%= bufalo.peso %>">
                                    </div>
                                    <div class="form-group">
                                        <label for="raca<%= bufalo.id %>">Raça</label>
                                        <input type="text" class="form-control" id="raca<%= bufalo.id %>" name="raca" value="<%= bufalo.raca %>">
                                    </div>
                                    <div class="form-group">
                                        <label for="sexo<%= bufalo.id %>">Sexo</label>
                                        <input type="text" class="form-control" id="sexo<%= bufalo.id %>" name="sexo" value="<%= bufalo.sexo %>">
                                    </div>
                                    <div class="form-group">
                                        <label for="dataNascimento<%= bufalo.id %>">Data de Nascimento</label>
                                        <input type="date" class="form-control" id="dataNascimento<%= bufalo.id %>" name="dataNascimento" value="<%= bufalo.dataNascimento.toISOString().split('T')[0] %>">
                                    </div>
                                    <div class="form-group">
                                        <label for="comprimentoCorporal<%= bufalo.id %>">Comprimento Corporal</label>
                                        <input type="text" class="form-control" id="comprimentoCorporal<%= bufalo.id %>" name="comprimentoCorporal" value="<%= bufalo.comprimentoCorporal %>">
                                    </div>
                                    <div class="form-group">
                                        <label for="circunferenciaCorporal<%= bufalo.id %>">Circunferência Corporal</label>
                                        <input type="text" class="form-control" id="circunferenciaCorporal<%= bufalo.id %>" name="circunferenciaCorporal" value="<%= bufalo.circunferenciaCorporal %>">
                                    </div>
                                    <div class="form-group">
                                        <label for="alturaCernelha<%= bufalo.id %>">Altura da Cernelha</label>
                                        <input type="text" class="form-control" id="alturaCernelha<%= bufalo.id %>" name="alturaCernelha" value="<%= bufalo.alturaCernelha %>">
                                    </div>
                                    <div class="form-group">
                                        <label for="suplementacao<%= bufalo.id %>">Tipo de Suplementos</label>
                                        <input type="text" class="form-control" id="suplementacao<%= bufalo.id %>" name="suplementacao" value="<%= bufalo.suplementacao %>">
                                    </div>
                                    <div class="form-group">
                                        <label for="tipoRacao<%= bufalo.id %>">Tipo de Ração</label>
                                        <input type="text" class="form-control" id="tipoRacao<%= bufalo.id %>" name="tipoRacao" value="<%= bufalo.tipoRacao %>">
                                    </div>
                                    <div class="form-group">
                                        <label for="tipoPastagem<%= bufalo.id %>">Tipo de Pastagem</label>
                                        <input type="text" class="form-control" id="tipoPastagem<%= bufalo.id %>" name="tipoPastagem" value="<%= bufalo.tipoPastagem %>">
                                    </div>
                                    <button type="submit" class="btn btn-primary">Salvar</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal Excluir -->
                <div class="modal fade" id="deleteBufaloModal<%= bufalo.id %>" tabindex="-1" role="dialog" aria-labelledby="deleteBufaloModalLabel<%= bufalo.id %>" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="deleteBufaloModalLabel<%= bufalo.id %>">Excluir Búfalo</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                Tem certeza de que deseja excluir o búfalo <strong><%= bufalo.nome %></strong>?
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                                <form action="/deleteBufalo/<%= bufalo.id %>" method="POST">
                                    <button type="submit" class="btn btn-danger">Excluir</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <% }); %>
            </tbody>
        </table>
    </section>
</div>

<!-- Modal Adicionar -->
<div class="modal fade" id="createBufaloModal" tabindex="-1" role="dialog" aria-labelledby="createBufaloModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="createBufaloModalLabel">Adicionar Búfalo</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="/createBufalo" method="POST">
                    <div class="form-group">
                        <label for="tag">Tag</label>
                        <input type="text" class="form-control" id="tag" name="tag">
                    </div>
                    <div class="form-group">
                        <label for="valorArroba">Valor Arroba</label>
                        <input type="text" class="form-control" id="valorArroba" name="valorArroba">
                    </div>
                    <div class="form-group">
                        <label for="nome">Nome</label>
                        <input type="text" class="form-control" id="nome" name="nome">
                    </div>
                    <div class="form-group">
                        <label for="idade">Idade</label>
                        <input type="text" class="form-control" id="idade" name="idade">
                    </div>
                    <div class="form-group">
                        <label for="peso">Peso</label>
                        <input type="text" class="form-control" id="peso" name="peso">
                    </div>
                    <div class="form-group">
                        <label for="raca">Raça</label>
                        <input type="text" class="form-control" id="raca" name="raca">
                    </div>
                    <div class="form-group">
                        <label for="sexo">Sexo</label>
                        <input type="text" class="form-control" id="sexo" name="sexo">
                    </div>
                    <div class="form-group">
                        <label for="dataNascimento">Data de Nascimento</label>
                        <input type="date" class="form-control" id="dataNascimento" name="dataNascimento">
                    </div>
                    <div class="form-group">
                        <label for="comprimentoCorporal">Comprimento Corporal</label>
                        <input type="text" class="form-control" id="comprimentoCorporal" name="comprimentoCorporal">
                    </div>
                    <div class="form-group">
                        <label for="circunferenciaCorporal">Circunferência Corporal</label>
                        <input type="text" class="form-control" id="circunferenciaCorporal" name="circunferenciaCorporal">
                    </div>
                    <div class="form-group">
                        <label for="alturaCernelha">Altura da Cernelha</label>
                        <input type="text" class="form-control" id="alturaCernelha" name="alturaCernelha">
                    </div>
                    <div class="form-group">
                        <label for="suplementacao">Tipo de Suplementos</label>
                        <input type="text" class="form-control" id="suplementacao" name="suplementacao">
                    </div>
                    <div class="form-group">
                        <label for="tipoRacao">Tipo de Ração</label>
                        <input type="text" class="form-control" id="tipoRacao" name="tipoRacao">
                    </div>
                    <div class="form-group">
                        <label for="tipoPastagem">Tipo de Pastagem</label>
                        <input type="text" class="form-control" id="tipoPastagem" name="tipoPastagem">
                    </div>
                    <button type="submit" class="btn btn-primary">Adicionar</button>
                </form>
            </div>
        </div>
    </div>
</div>

<%- include('partials/footer.ejs') %>
